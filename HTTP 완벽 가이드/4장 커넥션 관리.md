# 4장 커넥션 관리

## TCP 커넥션
* 모든 HTTP 통신은 TCP/IP 를 통해 이루어진다. 왜냐하면 HTTP 프로토콜 하부에 TCP/ IP 프로토콜이 존재하기 때문에. OSI 7게층을 살펴보면 애플리케이션 레이어 아래에 트랜스포트 레이어와 네트워크 레이어가 존재한다.

* 커넥션이 맺어지고 나서 클라이언트와 서버간의 주고받는 메세지는 순서가 뒤바뀌지 않으며 안전하게 전달된다.

* 하나의 시나리오를 생각.  
  1. 브라우저 주소 창에 www.naver.com 을 입력후 엔터
  2. 브라우저는 www.naver.com 의 호스트명을 추출하고 해당 도메인에서 IP 를 획득한다. (DNS Server & Root DNS Server 관련 내용)
  3. 브라우저는 해당 포트번호를 획득
  4. 브라우저는 획득한 IP와 포트번호를 통하여 TCP 커넥션을 생성 (TCP three - handwaking 관련 내용)
  5. 4의 과정에서 기본 게이트웨이 (첫번째 라우터) 로 패킷 전송 (TCP 커넥션을 맺기위한 절차)
  6. 커넥션이 맺어지고, 브라우저는 HTTP GET 요청 메세지를 서버로 전달
  7. 서버로부터 HTTP 응답 메시지를 읽음
  8. 커넥션을 끊는다.
  
* TCP 는 HTTP에게 신뢰할 수 있는 통신 방식을 제공하는데, TCP 커넥션의 한쪽에 있는 바이트들은 반대쪽으로 __순서에 맞게__ 정확히 전달된다.

* 트랜스포트 레이어에서 네트워크 레이어로 캡슐화 되면서 헤더 및 데이터가 저장 (Packet 안에 Segment 가 존재)

* 두 개의 TCP 커넥션이 있는 경우 아래 네가지 값은 모두 동일할 수 없다.
  1. 발신지 IP 주소
  2. 발신지 포트
  3. 수신지 IP 주소
  4. 수신지 포트
